local Players = game:GetService("Players")
local player = Players.LocalPlayer

-- Folder paths
local tokensFolder = workspace:WaitForChild("Items")
	:WaitForChild("Tokens")
	:WaitForChild("Client")

local collectablesFolder = workspace:WaitForChild("Items")
	:WaitForChild("Misc")
	:WaitForChild("Collectables")

-- SETTINGS
local TRAVEL_COOLDOWN = 20 * 60 -- 20 minutes
local TRAVEL_DELAY = 5 -- 5 seconds between TT1 and TT2

-- State lock
local priorityActive = false

-- Teleport function
local function teleportToPart(part)
	if not part or not part:IsA("BasePart") then return end
	
	local character = player.Character or player.CharacterAdded:Wait()
	local hrp = character:WaitForChild("HumanoidRootPart")
	
	hrp.CFrame = part.CFrame + Vector3.new(0, 3, 0)
end

-- ===============================
-- TRAVEL TOKEN PRIORITY SYSTEM
-- ===============================

task.spawn(function()
	while true do
		task.wait(10)

		priorityActive = true
		print("Starting Travel Token priority sequence")

		local tt1 = collectablesFolder:FindFirstChild("TravelToken1")
		local tt2 = collectablesFolder:FindFirstChild("TravelToken2")

		if tt1 and tt1:IsA("BasePart") then
			teleportToPart(tt1)
			task.wait(TRAVEL_DELAY)
		end

		if tt2 and tt2:IsA("BasePart") then
			teleportToPart(tt2)
			task.wait(TRAVEL_DELAY)
		end

		print("Travel sequence complete. Cooldown restarting.")
		priorityActive = false

    task.wait(TRAVEL_COOLDOWN)
	end
end)

-- ===============================
-- NORMAL CLIENT TOKEN SYSTEM
-- ===============================

local function isValidToken(part)
	if not part:IsA("BasePart") then return false end
	local number = tonumber(part.Name)
	return number and number >= 1 and number <= 30
end

-- Existing tokens
for _, child in ipairs(tokensFolder:GetChildren()) do
	if isValidToken(child) and not priorityActive then
		teleportToPart(child)
		break
	end
end

-- New spawns
tokensFolder.ChildAdded:Connect(function(child)
	if priorityActive then return end
	
	if isValidToken(child) then
		teleportToPart(child)
	end
end)
